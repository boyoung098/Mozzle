<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mozzle.web.Users">

<select id="loginChk" parameterType="java.lang.String" resultType="uDto">
  SELECT u.USER_PW, a.AUTH_NAME AUTH
	FROM USERS u INNER JOIN USERS_AUTH a
	ON u.AUTH_CODE = a.AUTH_CODE 
		WHERE u.USER_ID = #{id}
</select>

<select id="passwordChk" parameterType="java.lang.String" resultType="java.lang.String">
  SELECT USER_PW 
	FROM USERS
		WHERE USER_ID = #{id}
</select>

<insert id="signUp" parameterType="uDto">
	INSERT INTO USERS(USER_ID, USER_PW, USER_NAME, AUTH_CODE, BIRTH, EMAIL, TEL, DELFLAG)
		VALUES(#{user_id}, #{user_pw}, #{user_name},
		2, #{birth}, #{email},
		#{tel}, 'N')
</insert>

<select id="duplicationIdChk" parameterType="java.lang.String" resultType="java.lang.Integer">
	SELECT COUNT(*) FROM USERS WHERE USER_ID = #{id}
</select>

<select id="getUserInfo" parameterType="java.lang.String" resultType="uDto">
	SELECT USER_NAME, BIRTH, EMAIL, TEL
	FROM USERS WHERE USER_ID = #{id}
</select>

<select id="duplicationMailChk" parameterType="java.lang.String" resultType="java.lang.Integer">
	SELECT COUNT(*) FROM USERS WHERE EMAIL = #{email}
</select>

<select id="findId" parameterType="uDto" resultType="java.lang.String">
	SELECT USER_ID FROM USERS WHERE EMAIL = #{email} AND USER_NAME = #{user_name}	
</select>

<select id="findPw" parameterType="uDto" resultType="java.lang.Integer">
	SELECT COUNT(*) FROM USERS WHERE EMAIL = #{email} AND USER_ID = #{user_id} AND USER_NAME = #{user_name}
</select>

</mapper>
